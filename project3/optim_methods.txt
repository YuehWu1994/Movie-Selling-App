We use 2 methods to for XML parsing optimization. One is cache. We cached the result of the query to limit the numbers of the queries to the database. We used a Hash set to store movies id and stars id to prevent the query of the same id to the database. We also built the map for genres to record the type of the genres and the corresponding id. The other method used to speed up the parsing is sorting. We sorted the tables based on their primary key before insertion. The following is the result of our methods and the comparison.

No optimization:
50 secs

Only cache the query result method
42 secs

Only sort the primary key method
43 secs

Both methods
40 secs
